########################################################################################
########################################################################################
#
# Filter never-via-route=server  networks
#
########################################################################################
########################################################################################

define NEVER_ASN = [ 92, 174, 278, 680, 714,
1273, 1299, 1955, 2152, 2914, 3257, 3265, 3292,
3320, 3491, 3630, 3754, 5391, 5432, 5511, 6079,
6730, 6805, 6830, 6908, 7155, 7843, 7862, 8075,
8365, 8455, 8607, 8943, 9908, 10013, 11164,
11260, 11290, 11670, 12322, 12353, 12822, 12926,
13030, 13032, 13941, 14295, 14430, 15692, 16509,
17012, 18520, 19237, 20115, 20161, 21396, 23888,
23961, 24282, 24800, 25215, 26068, 27947, 29169,
30967, 30983, 31764, 32840, 33983, 34108, 34209,
34587, 35836, 35900, 36165, 36459, 37271, 37529,
38713, 39326, 39651, 40029, 40063, 43470, 46450,
47377, 47583, 47584, 48237, 48265, 48408, 49127,
49695, 49910, 49922, 50670, 51530, 51630, 52990,
53859, 54295, 54574, 55244, 57433, 57866, 58768,
60412, 60449, 60757, 61525, 61756, 62164, 62350,
62567, 62623, 63290, 63739, 131398, 131996,
132563, 132829, 132996, 134022, 135706, 135848,
136106, 136874, 136964, 137207, 137610, 138023,
138769, 138953, 139667, 140287, 141091, 141120,
141134, 141140, 141411, 141856, 141892, 142164,
142348, 142369, 146846, 146958, 147059, 149296,
149391, 149587, 149663, 149826, 201978, 202256,
202351, 202561, 202793, 206275, 207484, 208425,
209310, 209699, 210030, 210715, 212512, 212623,
212706, 213202, 262191, 262888, 263258, 263686,
263856, 264424, 265337, 265630, 267214, 267561,
268091, 269190, 269367, 269512, 269906, 270407,
270544, 270781, 270828, 271053, 271172, 271200,
271791, 272018, 272097, 272124, 272174, 327732,
328445, 328572, 328959, 393573, 393684, 396304,
396477, 398203, 398395, 399338 ];


function filter_has_never_asn()
int set never_asns;
{
    never_asns = NEVER_ASN;
    if (bgp_path ~ never_asns) then {
        bgp_large_community.add( IXP_LC_FILTERED_NEVER_VIA_ROUTE_SERVER );
        return true;
    }

    return false;
}
